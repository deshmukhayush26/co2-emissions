import os
import zipfile
import pandas as pd
import numpy as np
# 1. Paths
zip_path = "/kaggle/input/co2-dataset-3/co2_dataset.csv"   # zipped file
extract_path = "/kaggle/working/co2_extracted"

# 2. Create extraction folder
os.makedirs(extract_path, exist_ok=True)

# 3. Extract ZIP
with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    zip_ref.extractall(extract_path)

# 4. See what's inside
print(os.listdir(extract_path))

df = pd.read_csv(
    f"{extract_path}/dataset.csv",
    encoding="latin1",
    engine="python",
    sep=",",
    on_bad_lines="skip"
)

df["date"] = pd.to_datetime(df["date"], dayfirst = True)
df["year"] = df["date"].dt.year
df["month"] = df["date"].dt.month

df_encoded = pd.get_dummies(
    df,
    columns=["country", "sector"],
    drop_first=True
)

X = df_encoded.drop(columns=["value", "date"])
y = df_encoded["value"]
X.shape, y.shape

from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.2,
    random_state=42
)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

r2 = r2_score(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)

r2, rmse

import statsmodels.api as sm

X_simple = df[["year", "month"]]
y = df["value"]

X_simple = sm.add_constant(X_simple)

model_sm = sm.OLS(y, X_simple).fit()
model_sm.summary()
